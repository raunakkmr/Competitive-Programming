The current solution for i is too slow.
